<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.3" />
		<meta name="keywords" content="Internal error handling,Sford CC0,Sford wiki,Sford" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Geekyinfo (en)" />
		<link rel="alternate" type="application/rss+xml" title="Geekyinfo RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Geekyinfo Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Internal error handling - Geekyinfo</title>
		<link rel="stylesheet" href="/w/skins/common/shared.css?207" type="text/css" media="screen" />
		<link rel="stylesheet" href="/w/skins/common/commonPrint.css?207" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/skins/monobook/main.css?207" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE50Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE55Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/w/skins/monobook/IE60Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/w/skins/monobook/IE70Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/w/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/w/skins";
		var wgArticlePath = "/w/index.php?title=$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://wiki.geeky-boy.com";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Internal_error_handling";
		var wgTitle = "Internal error handling";
		var wgAction = "view";
		var wgArticleId = "46";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 557;
		var wgVersion = "1.15.3";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/w/skins/common/wikibits.js?207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/w/skins/common/ajax.js?207"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Internal_error_handling skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Internal error handling</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Geekyinfo</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><big><b><a href="/w/index.php?title=User:Sford" title="User:Sford">User:Sford</a> &gt; <a href="/w/index.php?title=Sford_wiki" title="Sford wiki">Sford wiki</a> &gt; Internal error handling</b></big>
</p><p>See <a href="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" class="external text" title="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" rel="nofollow">my blog</a> for the justifications for this approach.
</p><p>Here's some code that should be in everybody's Unix C programs.  It's newly-refined, so don't get on my case if you see some of my code that doesn't have it in this form.  This code is <a href="/w/index.php?title=Sford_CC0" title="Sford CC0">Public Domain</a>; use freely without restriction.
</p>
<pre>
/* Minimal but very useful error handling. */
#define WCHK(cond_expr) do { \
  if (!(cond_expr)) { \
    fprintf(stderr, &quot;%s:%d, Warning, expected '%s' to be true (%s)\n&quot;, \
      __FILE__, __LINE__, #cond_expr, strerror(errno)); \
  }  \
} while (0)

#define ECHK(cond_expr) do { \
  if (!(cond_expr)) { \
    fprintf(stderr, &quot;%s:%d, Error, expected '%s' to be true (%s)\n&quot;, \
      __FILE__, __LINE__, #cond_expr, strerror(errno)); \
    abort(); \
  }  \
} while (0)
</pre>
<p>These macros are basically a better <tt>assert()</tt>.  In addition to just printing the file/line/conditional, it also prints the human-readable string for <tt>errno</tt>, which might not be applicable for a particular usage, but it's useful enough when it *is* applicable that I just always include it.  <tt>WCHK()</tt> is for warnings (i.e it prints the message but continues execution).  <tt>ECHK()</tt> is for fatal errors (i.e. calls <tt>abort()</tt> which dumps core).  Both should be used for conditions that "should never happen".  A failure typically indicates a software bug that needs to be tracked own and fixed.
</p><p>They should be used like <tt>assert()</tt>, passing in a boolean expression, typically a conditional.  For example:
</p>
<pre>
char *buf = malloc(65536);  ECHK(buf&nbsp;!= NULL);

FILE *state_fd = fopen(&quot;statefile&quot;, &quot;r&quot;);  WCHK(x_fd&nbsp;!= NULL);  /* we ship initial state file, should never fail. */
if (state_fd == NULL) {
    create_statefile();
}
FILE *state_fd = fopen(&quot;statefile&quot;, &quot;r&quot;);  ECHK(x_fd&nbsp;!= NULL);
</pre>
<p>The <tt>WCHK()</tt> macro should *<i>rarely</i>* be used.  Most errors that have reasonable recovery measures are actually user errors.  User errors should have much better error messages that tell the user what he did wrong and what he should do to correct it.
</p><p>Note that the macros above are different from the ones in <a href="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" class="external text" title="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" rel="nofollow">my blog</a>.  The use of <tt>errno</tt> and <tt>abort()</tt> is not always appropriate for complicated software systems.  The blog version is more generally applicable to a variety of system-level error handling frameworks.  But for Unix tools, the macros above are usually fine.
</p><p>But don't just include these macros in your program and then forget about them!  As described in <a href="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" class="external text" title="http://blog.geeky-boy.com/2014/06/error-handling-enemy-of-readability.html" rel="nofollow">my blog</a>, the point of these is to make liberal use of sanity checks in your code, but do so in a way that doesn't significantly degrade your code's readability.  DOWN WITH UNCHECKED RETURN STATUSES AND NEEDLESSLY INDENTED CODE!  (Hmm ... better re-think my career dream as sloganeer.)
</p>
<!-- 
NewPP limit report
Preprocessor node count: 7/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sford_wikidb-gi_:pcache:idhash:46-0!1!0!!en!2!edit=0 and timestamp 20171202192835 -->
<div class="printfooter">
Retrieved from "<a href="http://wiki.geeky-boy.com/w/index.php?title=Internal_error_handling">http://wiki.geeky-boy.com/w/index.php?title=Internal_error_handling</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/w/index.php?title=Internal_error_handling" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="/w/index.php?title=Talk:Internal_error_handling&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="/w/index.php?title=Internal_error_handling&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=Internal_error_handling&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Internal_error_handling" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(skins/common/images/GeekyInfo.jpg);" href="/w/index.php?title=Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/w/index.php?title=Main_Page">Main Page</a></li>
				<li id="n-portal"><a href="/w/index.php?title=Geekyinfo:Community_Portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="/w/index.php?title=Geekyinfo:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="/w/index.php?title=Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/w/index.php?title=Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="/w/index.php?title=Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Geekyinfo [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/w/index.php?title=Special:WhatLinksHere/Internal_error_handling" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/w/index.php?title=Special:RecentChangesLinked/Internal_error_handling" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/w/index.php?title=Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=Internal_error_handling&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=Internal_error_handling&amp;oldid=557" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/w/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 24 January 2016, at 15:56.</li>
					<li id="viewcount">This page has been accessed 1,239 times.</li>
					<li id="privacy"><a href="/w/index.php?title=Geekyinfo:Privacy_policy" title="Geekyinfo:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/w/index.php?title=Geekyinfo:About" title="Geekyinfo:About">About Geekyinfo</a></li>
					<li id="disclaimer"><a href="/w/index.php?title=Geekyinfo:General_disclaimer" title="Geekyinfo:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.077 secs. --></body></html>
